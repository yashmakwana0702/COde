package lab7;
import java.sql.*;
import java.sql.Date ;
import java.util.*;
public class stud extends MySQL{
static Scanner sc=new Scanner(System.in);
	public static void main(String[] args) throws SQLException {
		// TODO Auto-generated method stub
		Statement sta=stat();
		int x=1;
		while(x!=0) {
			System.out.println("1--> enter to see student table in database  ");
			System.out.println("2--> enter to see Department table in database  ");
			System.out.println("3--> enter to see branch table in database  ");
			System.out.println("4--> enter to see course table in database  ");
			System.out.println("5--> enter to see branch-course table in database  ");
			System.out.println("6--> enter to see enroll table in database  ");
			System.out.println("7--> enter to insert data into  student table in database  ");
			System.out.println("8--> enter to to enroll student in courses");
			System.out.println("9--> enter to insert branch or department or course");
			System.out.println("10--> enter to see view or lists");
			System.out.println("0--> to exit the program  ");
			x= sc.nextInt();
			switch(x){
			case 7: insertstud(sta);
			case 1: displaystudent(sta);
					break;
			case 2:
				displaydepartment(sta);
				break;
			case 3:
				displayBranch(sta);
				break;
			case 4:
				displaycourse(sta);
				break;
			case 5:
				displayBC(sta);
				break;
			case 8:insertenrol(sta);
			case 6:
				displayenroll(sta);
				break;
			case 9:
				insert(sta);
				break;
			case 10:
				display(sta);
			default :
				System.out.println("the code is finish");
				x=0;
				break;
			}
		}
	}
	static void insertstud(Statement sta) throws SQLException {
			System.out.println();
			System.out.println("the name of student  is :" );
			String na=sc.next();
			System.out.println();
			System.out.println("the roll no  for student  is :" );
			int ro =sc.nextInt();
			System.out.println("The gender of student is " );
			String gen = sc.next();
			System.out.println("The date of birth of student is in dd-mm-yyyy format " );
			String dOB = sc.next();
			System.out.println("The Date of joining of student is  in dd-mm-yyyy format" );
			String DoA=sc.next();
			System.out.println("The Branch code of student is " );
			int bno= sc.nextInt();
		String sin=" INSERT INTO student VALUES ("+ro+", '"+na+"',STR_TO_DATE('"+dOB+"', '%d-%m-%Y'),'"+gen+"',STR_TO_DATE('"+DoA+"', '%d-%m-%Y'), "+bno+")";
		boolean rset = sta.execute(sin);
		System.out.println(rset);
	}
	static void insertenrol(Statement sta) throws SQLException {
		try(Scanner sc=new Scanner(System.in)){
		System.out.println();
		System.out.println("the roll no  for student  is :" );
		int ro =sc.nextInt();
		System.out.println("The course code of course is " );
		int co=sc.nextInt();
		System.out.println("enter the semester ");
		String gen = sc.next();
		System.out.println("The GRADE of student is " );
		String GRA= sc.next();
		String sin=" INSERT INTO enrolls  VALUES ("+ro+"," +co+", '"+gen+ "', '"+GRA+"') ";
		boolean rset = sta.execute(sin);
		System.out.println(rset);
		displayenroll(sta);
		}
		}
	static void display(Statement sta) {
		System.out.println("List details of Departments that offer more than 3 branches./n"
				+ "f.) List the details of Departments that offer more than 6 courses.\n/n"
				+ "g.) List the details of courses that are common for more than 3 branches."
				+ "h.) List students who got ‘S’ in more than 2 courses during single enrollment.");
	}
}
