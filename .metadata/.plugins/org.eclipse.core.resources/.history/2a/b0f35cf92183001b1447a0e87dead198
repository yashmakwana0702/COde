package lab7;
import java.sql.*;
import java.util.Scanner;
public class sql_item {
	public static Scanner sc=new Scanner(System.in);
	  static Statement smt() {
	      try {
	    		  Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/cus_it?allowMultiQueries=true","root", "2648");
	    		  Statement stmt = conn.createStatement();
	    		  System.out.println(stmt);
	    		  return stmt;  
	    		  }
	       catch(SQLException ex) {
	         ex.printStackTrace();
	         return null; 
	      }
	   }
	static void displaycustomer(Statement stmt) throws SQLException{
        String strSelect = "select * from customer";
        System.out.println("The SQL statement is: " + strSelect + "\n"); 
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:\n");
        System.out.format("%10s%20s\n","Customer No","Name " );
        while(rset.next()) {   
        	String Rol = rset.getString("CUSTOMERNO");
        	String name = rset.getString("cname");
        	System.out.format("%10s%20s\n",Rol,name);        	
        }       
        System.out.println();
     } 
	static void displayitem(Statement stmt) throws SQLException{
        String strSelect = "select * from item";
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:\n");
        System.out.format("%10s%20s%5s\n","Item No","Name ","Unit price" );
        while(rset.next()) {   
        	String Rol = rset.getString("ITEMNO");
        	String name = rset.getString("ITEM_NAME");
        	int rs=rset.getInt("UNIT_PRICE");
        	System.out.format("%10s%20s%5d\n",Rol,name,rs);        	
        }       
        System.out.println();
     } 
	static void displayORD_item(Statement stmt) throws SQLException{
        String strSelect = "select * from item";
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:\n");
        System.out.format("%10s%20s%5s\n","Order No","Item number ","Quantity" );
        while(rset.next()) {   
        	String Rol = rset.getString("ORDERNO");
        	String name = rset.getString("ITEMNO");
        	int rs=rset.getInt("QTY");
        	System.out.format("%10s%20s%5d\n",Rol,name,rs);        	
        }       
        System.out.println();
     }  
	static void displaycourse(Statement stmt) throws SQLException{
        String strSelect = "select * from stud.course";
        System.out.println("The SQL statement is: " + strSelect + "\n"); // Echo For debugging
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:");
        int rowCount = 0;
        System.out.format("%10s%20s%10s%5s\n","branch no","Name ","Credit "," Department no" );
        while(rset.next()) {   
        	int Rol = rset.getInt("CCODE");
        	String name = rset.getString("cname");
        	int credit=rset.getInt("Credits");
        	int dno=rset.getInt("DNO");
        	System.out.format("%10d%20s%8d%5d\n",Rol,name,credit,dno);
        	rowCount++;
        }
        System.out.println("Total number of records = " + rowCount);
        System.out.println();
     }
	static void displaycust_order(Statement stmt) throws SQLException{
        String strSelect = "select * from stud.enrolls";
        System.out.println("The SQL statement is: " + strSelect + "\n"); // Echo For debugging
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:");
        int rowCount = 0;
        System.out.format("%10s%10s%15s%5s\n","Roll no","C_Code ","Session "," Grade" );
        while(rset.next()) {   
        	int Rol = rset.getInt("ROLLNO");
        	String name = rset.getString("SESS");
        	int credit=rset.getInt("CCODE");
        	String grade=rset.getString("GRADE");
        	System.out.format("%10d%10d%15s%5s\n",Rol,credit,name,grade);
        	rowCount++;
        }
        System.out.println("Total number of records = " + rowCount);
        System.out.println();
     }
	static void displayorder_item(Statement stmt) throws SQLException{
        String strSelect = "select * from stud.branch_course";
        System.out.println("The SQL statement is: " + strSelect + "\n"); // Echo For debugging
        ResultSet rset = stmt.executeQuery(strSelect);
        System.out.println("The records selected are:");
        int rowCount = 0;
        System.out.format("%10s%10s%20s\n","branch no","course no","Semester " );
        while(rset.next()) {   
        	int Rol = rset.getInt("BCODE");
        	int col = rset.getInt("CCODE");
        	String name = rset.getString("SEMESTER");
        	System.out.format("%10d%10d%20s\n",Rol,col,name);
        	rowCount++;
        }
        System.out.println("Total number of records = " + rowCount);
        System.out.println();
     } 
	static void insert(Statement sta) throws SQLException {
		System.out.println("1--> enter to insert CUSTOMER");
		System.out.println("2--> enter to insert branch");
		System.out.println("3--> enter to insert course");
		int a=sc.nextInt();
		switch (a) {
		case 1:
			System.out.println("enter the Department no :");
			int dno=sc.nextInt();
			System.out.println("enter the Department name");
			String dname=sc.nextLine();
			String S1="INSERT INTO `cus_it`.`customer` (`CUSTOMERNO`, `CNAME`) VALUES ('C0015', 'SHRUTI');\r\n";
			String s ="INSERT INTO department VALUES ("+dno+", '"+dname+"')";
			boolean rset = sta.execute(s);
			System.out.println(rset);
			displaydepartment(sta);
			break;
		case 2:
			System.out.println("enter the Department no :");
			int dno1=sc.nextInt();
			System.out.println("enter the branch no :");
			int bno=sc.nextInt();
			System.out.println("enter the branch name");
			String bname=sc.nextLine();
			String s1 ="INSERT INTO branch VALUES ("+bno+", '"+bname+"',"+dno1+")";
			boolean rset1 = sta.execute(s1);
			System.out.println(rset1);
			displayBranch(sta);
			break;
		case 3:
			System.out.println("enter the Department no :");
			int dno11=sc.nextInt();
			System.out.println("enter the course code  :");
			int cno=sc.nextInt();
			System.out.println("enter the course credit  :");
			int cre=sc.nextInt();
			System.out.println("enter the course name");
			String cname=sc.nextLine();
			String s11 ="INSERT INTO branch VALUES ("+cno+", '"+cname+"',"+cre+","+dno11+")";
			boolean rset11 = sta.execute(s11);
			System.out.println(rset11);
			System.out.println("enter the Branch code :");
			int bno1=sc.nextInt();
			System.out.println("enter the semester  :");
			int sem=sc.nextInt();
			String s12=" INSERT INTO branch_courseVALUES ("+bno1+"," +cno+ ","+sem+") " ;
			boolean rset12=sta.execute(s12);
			System.out.println(rset12);
			break;
		default :
			System.out.println("enter valid input");
			break;
		}
	}
}

